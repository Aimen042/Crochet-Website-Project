<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Your Cart</title>
    <link href="/dist/output.css" rel="stylesheet" />
</head>

<body class="bg-amber-50 min-h-screen flex flex-col items-center py-6 px-4 sm:py-10 sm:px-6 lg:px-12">

    <!-- CART SECTION -->
    <section id="cartSection" class="w-full max-w-4xl bg-white rounded-2xl shadow p-4 sm:p-6 md:p-8">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2 mb-4">
            <h1 class="text-xl sm:text-2xl font-bold">Your Cart - Payment only (COD)</h1>
            <a href="/index.html" class="text-gray-500 hover:font-semibold text-sm sm:text-base">
                Back To Home
            </a>
        </div>

        <div id="cartList" class="divide-y"></div>

        <div class="flex flex-col sm:flex-row justify-between items-center mt-6 gap-4">
            <div id="cartTotal" class="text-lg sm:text-xl font-semibold">
                Total: Rs 0.00
            </div>
            <div class="flex flex-col sm:flex-row justify-center items-center gap-3 w-full sm:w-auto">
                <a href="/index.html"
                    class="w-full sm:w-auto text-center px-4 py-2 text-gray-600 hover:font-semibold hover:text-green-600">
                    Continue shopping
                </a>
                <button id="clearCartBtn"
                    class="w-full sm:w-auto px-4 py-2 rounded bg-gray-800 text-white hover:bg-gray-600 transition">
                    Clear Cart
                </button>
                <button onclick="submitOrder()" 
                    class="w-full sm:w-auto px-4 py-2 rounded bg-gray-800 text-white hover:bg-gray-600 transition">
                    Submit
                </button>
            </div>
        </div>
    </section>

    <!-- ORDER SUMMARY SECTION (hidden initially) -->
    <section id="orderSummarySection" 
        class="w-full max-w-4xl bg-green-50 border border-green-300 rounded-2xl shadow p-6 mt-6 hidden">
        <h2 class="text-xl font-bold text-green-700 mb-4">Order Summary</h2>
        <div id="orderDetails" class="space-y-2 text-gray-700">
            <!-- Order details will be inserted here -->
        </div>
        <p class="mt-4 font-semibold text-green-800">
            ✅ Your order has been placed successfully!
        </p>
        <div class="mt-6">
            <a href="/index.html" 
               class="px-4 py-2 rounded bg-gray-800 text-white hover:bg-gray-600 transition">
               Back to Home
            </a>
        </div>
    </section>

    <script src="/script.js" defer></script>
    <script>
        // Load cart items and total from localStorage
        function loadCart() {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];

            const list = document.getElementById("cartList");
            const totalEl = document.getElementById("cartTotal");

            list.innerHTML = "";

            if (!cart.length) {
                list.innerHTML = "<p class='py-4 text-gray-500'>Your cart is empty.</p>";
            } else {
                cart.forEach((item, index) => {
                    const row = document.createElement("div");
                    row.className = "flex justify-between items-center py-3";

                    row.innerHTML = `
                    <div class="flex justify-center items-center gap-3">
                        <img src="${item.image || '/src/assets/placeholder.png'}" 
                             alt="${item.name}" 
                             class="w-16 h-16 object-cover rounded" />
                        <div>
                            <div class="font-medium">${item.name}</div>
                            <div class="text-sm text-gray-500">
                                Rs ${item.price} × ${item.quantity}
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center gap-8">
                        <span class="font-semibold">Rs ${(item.price * item.quantity).toFixed(2)}</span>
                        <button class="text-red-600 hover:font-semibold" 
                                data-index="${index}" 
                                data-action="delete">Remove</button>
                    </div>
                `;
                    list.appendChild(row);
                });
            }

            // calculate total
            let total = cart.reduce((sum, item) => sum + item.price * item.quantity, 0);
            totalEl.textContent = "Total: Rs " + total.toFixed(2);
        }

        // Clear cart
        document.addEventListener("click", (e) => {
            if (e.target && e.target.id === "clearCartBtn") {
                if (!confirm("Clear cart?")) return;
                localStorage.removeItem("cart");
                loadCart();
            }

            // delete single item
            if (e.target && e.target.dataset.action === "delete") {
                let cart = JSON.parse(localStorage.getItem("cart")) || [];
                cart.splice(e.target.dataset.index, 1);
                localStorage.setItem("cart", JSON.stringify(cart));
                loadCart();
            }
        });

        // Run on page load
        loadCart();
    </script>


</body>

</html>